# DAY06

## 组件库

### 依赖的类型

| 名称                   | 提供插件            | 说明                                                                                          | 取代的旧版本           |
|------------------------|---------------------|-----------------------------------------------------------------------------------------------|------------------------|
| **compileOnly**        | java插件            | 适用于编译期需要而不需要打包的情况                                                            | provided               |
| **runtimeOnly**        | java插件            | 只在运行期有效，编译时不需要，如MySQL驱动包                                                   | runtime                |
| **implementation**     | java插件            | 针对源码[src/main目录]，在编译、运行时都有效                                                  | compile                |
| **testCompileOnly**    | java插件            | 用于编译测试的依赖项，运行时不需要                                                            | testCompile            |
| **testRuntimeOnly**    | java插件            | 只在测试运行时需要，而不是在测试编译时需要                                                    | testRuntime            |
| **testImplementation** | java插件            | 针对测试代码[src/test目录]，在编译、运行时都有效                                              | testCompile            |
| **providedCompile**    | war插件             | 编译、测试阶段需要依赖此类jar包，但运行阶段容器已经提供了相应支持，不需将文件打入war包中     | 无                     |
| **compile**            | 已移除              | 编译范围依赖在所有的classpath中可用，同时也会被打包                                           | gradle 7.0已移除       |
| **runtime**            | 已移除              | 运行和测试时需要，在编译时不需要                                                               | gradle 7.0已移除       |
| **api**                | java-library插件    | 这些依赖项可以传递性地导出给使用者，用于编译时和运行时                                        | compile                |
| **compileOnlyApi**     | java-library插件    | 在声明模块和使用者在编译时需要的依赖项，但在运行时不需要                                       | 无                     |


### Glide三级缓存

Glide 是一个强大的图片加载库，它使用三级缓存机制来提高图片加载的速度和性能。三级缓存的结构如下：

1. **内存缓存（Memory Cache）**:
    - 内存缓存是最快的缓存层，用于存储最近加载的图片。Glide 会首先尝试从内存中获取图片，如果存在就直接返回，避免了重复的解码和网络请求操作。
    - 内存缓存适用于频繁访问的图片，但由于内存资源有限，因此只适合缓存小数量的图片。

2. **本地磁盘缓存（Disk Cache）**:
    - 如果图片没有在内存缓存中找到，Glide 会尝试从本地磁盘缓存中获取。磁盘缓存通常存储已经下载和解码过的图片文件，避免了重复的网络请求。
    - 磁盘缓存相对于内存缓存更大，适合缓存更多的图片，但读取速度稍慢。

3. **远程网络加载（Network Load）**:
    - 如果图片既不在内存缓存中也不在磁盘缓存中，Glide 会通过网络请求来加载图片。加载完成后，图片会被保存到磁盘缓存和内存缓存中，以便后续访问。
    - 这是最慢的方式，因为需要进行网络请求和图片解码。

### 图片生命周期管理机制

Glide 不仅提供了强大的缓存机制，还对图片的生命周期管理进行了优化，确保图片的加载和展示与 Activity/Fragment 的生命周期同步。这种机制有助于减少内存泄漏和不必要的资源消耗。

1. **与生命周期同步**:
    - Glide 可以自动监测 `Activity` 或 `Fragment` 的生命周期事件（如 `onStart()`、`onStop()` 和 `onDestroy()`），并在合适的时间暂停或停止图片加载。这意味着当 `Activity` 不可见时，Glide 会自动暂停图片加载，减少资源消耗。

2. **请求的取消和恢复**:
    - 当 `Activity` 或 `Fragment` 恢复时，Glide 会恢复图片的加载。当它们被销毁时，Glide 会自动取消所有相关的图片请求，避免了内存泄漏。

3. **优化资源使用**:
    - 通过这种与生命周期的绑定，Glide 可以有效地管理资源使用，确保在恰当的时机释放内存和其他资源，从而提高应用的性能和稳定性。
